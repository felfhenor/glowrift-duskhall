<div class="game-container relative">
  <app-game-map-pixi class="absolute inset-0 map-layer"></app-game-map-pixi>

  @if (showOptions()) {
    <app-panel-container>
      <app-panel-options
        class="absolute inset-0 panel-layer"
      ></app-panel-options>
    </app-panel-container>
  }

  @if (showHeroes()) {
    <app-panel-container>
      <app-panel-heroes class="absolute inset-0 panel-layer"></app-panel-heroes>
    </app-panel-container>
  }

  @if (showInventory()) {
    <app-panel-container>
      <app-panel-inventory
        class="absolute inset-0 panel-layer"
      ></app-panel-inventory>
    </app-panel-container>
  }

  @if (showCombat()) {
    <app-panel-container>
      <app-panel-combat class="absolute inset-0 panel-layer"></app-panel-combat>
    </app-panel-container>
  }

  @if (showTown()) {
    <app-panel-container>
      <app-panel-town class="absolute inset-0 panel-layer"></app-panel-town>
    </app-panel-container>
  }

  @if (showWorld()) {
    <app-panel-container>
      <app-panel-world class="absolute inset-0 panel-layer"></app-panel-world>
    </app-panel-container>
  }

  @if (showLocation()) {
    <app-panel-container>
      <app-panel-location
        class="absolute inset-0 panel-layer"
      ></app-panel-location>
    </app-panel-container>
  }

  @if (contextMenu().visible) {
    <div
      class="fixed z-[1000] pointer-events-none"
      [style.left.px]="contextMenu().x"
      [style.top.px]="contextMenu().y"
    >
      <app-context-menu-stats-compare
        class="pointer-events-auto"
        [itemData]="contextMenu().itemData"
        [compareItem]="contextMenu().compareItem"
        [skillData]="contextMenu().skillData"
        [compareSkill]="contextMenu().compareSkill"
        [equippingHero]="contextMenu().equippingHero"
      ></app-context-menu-stats-compare>
    </div>
  }
</div>

@if (isCatchingUp()) {
  <div
    class="absolute top-[40px] left-0 z-100 w-full h-full flex justify-center items-center"
  >
    <div class="card bg-base-100 shadow-xl my-4 page-card mx-auto">
      <div class="card-body flex flex-row">
        <span class="loading loading-spinner loading-sm"></span>
        Catching up...
      </div>
    </div>
  </div>
}

@if (showWinNotification()) {
  <div
    class="absolute top-[40px] left-0 z-100 w-full h-full flex justify-center items-center"
  >
    <div class="card bg-base-100 shadow-xl my-4 page-card mx-auto">
      <div class="card-body">
        <div class="card-title">You Won!</div>

        <div>
          You can either keep playing or go back to the main menu again. It took
          you {{ winTicks() | number }} seconds to clear this world.
        </div>

        <div class="card-actions justify-end">
          <button class="btn btn-default" [routerLink]="['/']">
            Main Menu
          </button>
          <button class="btn btn-primary" (click)="continuePlayingPostWin()">
            Continue Playing
          </button>
        </div>
      </div>
    </div>
  </div>
}
