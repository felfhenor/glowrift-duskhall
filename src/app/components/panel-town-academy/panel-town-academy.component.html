@let chosen = selectedSkill();

<div class="flex flex-row gap-2 h-full">
  <div class="flex-1 flex flex-col h-full">
    <app-panel-town-building-upgrade
      [building]="'Academy'"
    ></app-panel-town-building-upgrade>
  </div>

  <div class="flex-2 card bg-base-100 foreground shadow-xl h-full panel-card">
    <div class="card-body">
      <div class="card-title">Selected Skill</div>

      @if (!chosen) {
        <app-blank-slate>Choose a skill</app-blank-slate>
      }

      @if (chosen) {
        <app-stats-skill
          [skill]="chosen"
          [showEquippedBy]="true"
        ></app-stats-skill>
      }
    </div>
  </div>

  <div class="flex-2 card bg-base-100 foreground shadow-xl panel-card">
    <div class="card-body">
      <div class="card-title">Actions</div>

      @if (!chosen) {
        <app-blank-slate>Choose a skill</app-blank-slate>
      }

      @if (chosen) {
        <ul class="list bg-base-100 rounded-box shadow-md">
          <li class="list-row">
            <button
              class="btn btn-block btn-info list-col-grow"
              [disabled]="!canIncreaseSymmetry()"
              (click)="increaseSymmetry(chosen)"
              appAnalyticsClick="Game:Town:Blacksmith:IncreaseSymmetry:{{
                chosen.name
              }}"
              appSfx="item-get-minor"
              [sfxTrigger]="['click', 'hover']"
            >
              Increase Symmetry ({{ symmetrySkillCount() }} matching)
            </button>
          </li>
        </ul>

        <div class="card-title">Enchantments</div>

        <ul class="list bg-base-100 rounded-box shadow-md">
          @for (path of enchantPaths(); track $index) {
            <li class="list-row">
              <button
                class="btn btn-block h-[60px] btn-neutral list-col-grow flex flex-col"
                [disabled]="!path.canEnchant"
                (click)="enchantSkill(chosen, path.path)"
                appAnalyticsClick="Game:Town:Academy:Enchant:{{ chosen.name }}"
                appSfx="item-get-minor"
                [sfxTrigger]="['click', 'hover']"
              >
                <app-button-cost-list
                  [label]="path.path.description"
                  [currencies]="path.path.cost"
                ></app-button-cost-list>
              </button>
            </li>
          } @empty {
            <li class="list-row">This skill cannot be upgraded.</li>
          }
        </ul>
      }
    </div>
  </div>
</div>

<app-card-page heightProfile="sub" *appTeleportTo="'panel-town'">
  <span header>Choose Skill To Upgrade</span>

  <app-inventory-grid-container
    [allowedItemTypes]="['equipped-skill', 'skill']"
    (skillClicked)="selectedSkill.set($event)"
    [allowItemClicks]="true"
    [containerHeight]="220"
    [disabledSkillIds]="chosen ? [chosen.id] : []"
  ></app-inventory-grid-container>
</app-card-page>
